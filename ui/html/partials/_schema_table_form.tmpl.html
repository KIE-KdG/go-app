{{define "schema_table_form"}}
<div class="flex flex-col space-y-8 w-full">
    <!-- Header/Title Section -->
    <div class="w-full">
        <legend class="text-2xl font-bold text-base-content">Database Search Configuration</legend>
    </div>

    <!-- Schema Selection Section -->
    <div class="card bg-base-100 shadow-lg w-full">
        <div class="card-body">
            <h2 class="card-title text-lg font-medium mb-4">1. Select Schema(s)</h2>

            {{if .ProjectSchemas}}

            <form action="/schema/create" method="POST" novalidate>
                <input type='hidden' name='csrf_token' value='{{.CSRFToken}}'>
                <input type='hidden' name='db_id' value='{{.ProjectDatabase.ID}}'>
                <input type='hidden' name='project_id' value='{{.Project.ID}}'>

                {{with .Form.DatabaseForm}}
                {{range .NonFieldErrors}}
                <div class='alert alert-error mb-4'>{{.}}</div>
                {{end}}
                {{end}}

                <div class="flex flex-col gap-4">
                    <label for="schemaName">Schemas:</label>
                    <select name="schemaName" id="schemaName" class="select select-bordered w-full h-40" size="5" multiple>
                        <!-- Loop through schema names directly without accessing .Name -->
                        {{range .ProjectSchemas}}
                        <option value="{{.}}">{{.}}</option>
                        {{end}}
                    </select>
                    <label class="label">
                        <span class="label-text-alt">Hold Ctrl/Cmd to select multiple schemas</span>
                    </label>

                    <button type="submit" id="fetchTable" class="btn btn-primary w-full">Fetch Tables</button>
                </div>
            </form>

            {{else}}
            <div class="bg-base-200 rounded-lg p-6 shadow-md">
                <p class="text-base-content">No schemas available for this project, please add a schema to
                    continue.</p>
            </div>
            {{end}}

        </div>
    </div>

    <!-- Rest of the template remains unchanged -->
    <!-- Tables Selection Section -->
    <div class="card bg-base-100 shadow-lg w-full" hidden>
        <div class="card-body">
            <h2 class="card-title text-lg font-medium mb-4">2. Select Tables and Columns</h2>

            <div class="mb-6">
                <div class="form-control w-full">
                    <input type="text" placeholder="Search tables..." id="table-search"
                           class="input input-bordered w-full"/>
                </div>
            </div>

            <div class="space-y-4" id="tables-container">
                <!-- Table entries remain unchanged -->
                <!-- ... -->
            </div>
        </div>
    </div>

    <!-- Submit Button Section -->
    <div class="card-actions justify-end mt-4 mb-8">
        <button type="submit" class="btn btn-primary btn-lg">Update data source</button>
    </div>
</div>
{{end}}